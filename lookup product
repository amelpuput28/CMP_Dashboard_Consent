select distinct account_type, sub_category, product_name
from ACL_DATALAKE.MART_DPK
WHERE AS_OF_DATE = '2025-07-31'
order by 1,2

select * from ACL_DATALAKE.MART_LOAN

ACL_DATALAKE.MART_CUSTOMER_CONSENT_ALL (summary)
acl_datalake.mart_customer_consent_icons (detail)

select * from prd_utl_datalake.lookup_product_tabungan
select * from prd_utl_datalake.lookup_product
select * from dm_funding.funding
select * from dm_lending.lending

select distinct cust_type, account_type, sub_category, product_name from dm_funding.funding
--select * from dm_funding.funding
where as_of_date = '2025-08-27'
and cust_type_code = '01'
--and product_name = 'GIRO TDK HIT BBB PERUSAHAAN'
--and cif_key = 9201673280
order by 1,2,3

select distinct cust_type, account_type, sub_category, product_name from dm_lending.lending
where as_of_date = '2025-08-27'
and cust_type_code = '01'
--and cif_key = 9201673280
order by 1,2,3

--final script
WITH baseline AS (
select cif_key,id_number,account_type,sub_category,currency,product_name,group_product
from PRD_DB_SBX_IND.DASH_DPK_DETAIL_REVAMP_v3
where as_of_date = '2025-08-28'
)

/*select consent.cif_key, base.id_number, base.account_type, base.sub_category, base.product_name, base.group_product
from acl_datalake.mart_customer_consent_icons consent
left join baseline base
on consent.cif_key = base.cif_key
where consent.as_of_date = '2025-08-28'
and consent.cif_key = 9201673280*/

select distinct consent.as_of_date, base.account_type, base.sub_category, base.currency, base.product_name, base.group_product
from acl_datalake.mart_customer_consent_icons consent
left join baseline base
on consent.cif_key = base.cif_key
where consent.as_of_date = '2025-08-28'
order by 1,2,3,4
